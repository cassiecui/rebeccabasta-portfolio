This dataset comes from CDC's Smoking-Attributable Mortality, Morbidity, and Economic Costs (SAMMEC). It looks at estimates of smoking-attributable health costs (millions of dollars)catergorized by states during the years of 2005-2009. 

Link to the source: https://data.cdc.gov/Health-Consequences-and-Costs/Smoking-Attributable-Mortality-Morbidity-and-Econo/ezab-8sq5/about_data

```{r}
library(tidyverse)
library(ggplot2)

# File path (your uploaded CSV in this workspace)
file_path <- "sae.csv"

## Read the data
sae_raw <- read.csv(file_path, stringsAsFactors = FALSE)

## Select variables that I will be using
sae_clean <- sae_raw %>%
  select(Year, LocationDesc, MeasureDesc, Data_Value, Data_Value_Unit)

## Clean Data_Value
sae_raw$Data_Value <- as.numeric(gsub(",", "", sae_raw$Data_Value))

## Variables
sae <- sae_raw[, c(
  "Year",
  "LocationAbbr",
  "LocationDesc",
  "TopicDesc",
  "MeasureDesc",
  "Variable",
  "Data_Value",
  "Data_Value_Type",
  "Data_Value_Unit"
)]

## Summary
summary(sae)
anyNA(sae$Data_Value)   # check missing numeric values

## Data after cleaning
head(sae, 10)
```

```{r}
##Summarize data
str(sae)
summary(sae)

## Distribution by year
sae %>%
  count(Year) %>%
  mutate(percent = n / sum(n) * 100)

## Distrubution by state
sae %>%
  count(LocationDesc) %>%
  mutate(percent = n / sum(n) * 100) %>%
  arrange(desc(percent))

## Histogram showing expenditure
ggplot(sae, aes(x = Data_Value)) +
  geom_histogram(bins = 30) +
    labs(title = "Distribution of Smoking-Attributable Expenditures",
        x = "Expenditure (Millions of Dollars)",
        y = "Count")

mean_value <- mean(sae$Data_Value, na.rm = TRUE)
sd_value   <- sd(sae$Data_Value, na.rm = TRUE)

mean_value
sd_value
summary(sae$Data_Value)
```

The distribution of smoking-attributable expenditures is skewed to the right. Most values show low expenditure levels, while a few observations show large values. The mean will probably be inflated due to the large values.

```{r}
##Boxplot
ggplot(sae, aes(y = Data_Value)) +
  geom_boxplot() +
  labs(title = "Boxplot of Smoking-Attributable Expenditures")
```

The boxplot of smoking-attributable expenditures is skewed to the right, with most of the observations having low values, while a few observations have large numbers. The large numbers in the data set increase variability.

```{r}
##Distribution by year
sae %>%
  group_by(Year) %>%
  summarise(mean_expenditure = mean(Data_Value, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = mean_expenditure)) + geom_line() + geom_point() +
  labs(title = "Mean Smoking-Attributable Expenditures by Year",
       x = "Year",
       y = "Mean Expenditure (Millions of Dollars)")
```

The mean smoking-attributable expenditures increased from 2005 to 2009, showing a positive linear trend over time. There is a consistent upward trend in smoking-related healthcare costs from 2005-2009.

```{r}
##Distribution by state
ggplot(sae, aes(x = reorder(LocationDesc, Data_Value, median),
                y = Data_Value)) + geom_boxplot() + 
  labs(title = "Distribution of Smoking-Attributable Expenditures by State",
       x = "State",
       y = "Expenditure (Millions of Dollars)")
```

The boxplot shows a lot of variability in smoking-attributable expenditures across states. Most states have low expenditure values, while a few states have higher expenditure values, which is why the boxplot is skewed to the right. The differences across states could be because of geographic and population factors.